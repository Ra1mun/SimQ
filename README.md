# SimQ - Система моделирования массового обслуживания

SimQ — это комплексная система для моделирования и анализа систем массового обслуживания (СМО), разработанная в Томском Государственном Университете.

## 📋 Оглавление

- [Описание проекта](#описание-проекта)
- [Архитектура системы](#архитектура-системы)
- [Технологический стек](#технологический-стек)
- [Требования](#требования)
- [Установка и запуск](#установка-и-запуск)
- [Структура проекта](#структура-проекта)
- [API документация](#api-документация)
- [Разработка](#разработка)
- [Лицензия](#лицензия)

## 🎯 Описание проекта

SimQ — это веб-приложение для создания, моделирования и анализа систем массового обслуживания. Система предоставляет:

- **Создание задач моделирования** — определение структуры СМО с различными типами агентов
- **Выполнение симуляций** — запуск моделирования с заданными параметрами
- **Сбор и анализ статистики** — получение детальных результатов моделирования
- **Визуализация** — графическое представление процессов и результатов
- **REST API** — программный доступ к функциональности системы

### Основные возможности

- Поддержка различных типов агентов моделирования
- Гибкая настройка параметров генерации и обслуживания
- Контроль точности моделирования через погрешность генерации
- Хранение истории задач и результатов
- Веб-интерфейс для удобной работы с системой

## 🏗️ Архитектура системы

Проект построен по многослойной архитектуре:

```
┌─────────────────────────────────────┐
│     Frontend (React + TypeScript)    │
│          Веб-интерфейс              │
└─────────────────┬───────────────────┘
                  │ HTTP/REST
┌─────────────────┴───────────────────┐
│      SimQ.WebApi (ASP.NET Core)     │
│         Web API слой                │
└─────────────────┬───────────────────┘
                  │
┌─────────────────┴───────────────────┐
│       SimQ.Core (Бизнес-логика)     │
│  - Модели                           │
│  - Сервисы                          │
│  - Модуль моделирования             │
│  - Сбор статистики                  │
└─────────────────┬───────────────────┘
                  │
┌─────────────────┴───────────────────┐
│    SimQ.DAL (Слой доступа к данным) │
│         Репозитории                 │
└─────────────────┬───────────────────┘
                  │
┌─────────────────┴───────────────────┐
│     SimQ.Domain (Доменные модели)   │
│         Entity классы               │
└─────────────────┬───────────────────┘
                  │
            ┌─────┴─────┐
            │  MongoDB  │
            └───────────┘
```

## 🛠️ Технологический стек

### Backend

- **.NET 8.0** — основной фреймворк
- **ASP.NET Core** — веб-фреймворк для REST API
- **MongoDB** — база данных для хранения задач и результатов
- **AutoMapper** — маппинг между объектами
- **Swagger/OpenAPI** — документация API

### Frontend

- **React 18.2** — UI библиотека
- **TypeScript 4.9** — типизированный JavaScript
- **Material-UI (MUI) 7.1** — компоненты интерфейса
- **D3.js 5.12** — визуализация данных
- **Dagre-D3 0.6** — визуализация графов

## 📦 Требования

### Для запуска приложения

- **.NET SDK 8.0** или выше
- **Node.js 16+** и **npm**
- **MongoDB 4.0** или выше
- **Windows/Linux/macOS**

### Для разработки (дополнительно)

- **Visual Studio 2022** или **JetBrains Rider**
- **VS Code** (для frontend разработки)

## 🚀 Установка и запуск

### 1. Клонирование репозитория

```bash
git clone https://github.com/Ra1mun/SimQ.git
cd SimQ
```

### 2. Настройка MongoDB

Убедитесь, что MongoDB запущена и доступна по адресу `mongodb://localhost:27017`.

Или измените строку подключения в `SimQ.WebApi/appsettings.json`:

```json
{
  "DatabaseSettings": {
    "ConnectionString": "mongodb://localhost:27017",
    "DatabaseName": "SimQDatabase"
  }
}
```

### 3. Запуск Backend (API)

```bash
cd SimQ.WebApi
dotnet restore
dotnet run
```

API будет доступен по адресу: `https://localhost:5001` или `http://localhost:5000`

Swagger UI: `https://localhost:5001/swagger`

### 4. Запуск Frontend

В отдельном терминале:

```bash
cd client
npm install
npm start
```

Веб-интерфейс будет доступен по адресу: `http://localhost:3000`

### 5. Запуск с помощью Docker (опционально)

```bash
# TODO: Добавить Dockerfile и docker-compose.yml
```

## 📁 Структура проекта

```
SimQ/
├── client/                      # Frontend приложение (React)
│   ├── src/
│   │   ├── domain/             # Доменные модели и типы
│   │   ├── services/           # Сервисы для работы с API
│   │   ├── widgets/            # React компоненты-виджеты
│   │   ├── App.tsx             # Главный компонент
│   │   └── index.tsx           # Точка входа
│   └── package.json
│
├── SimQ.Core/                   # Ядро приложения (бизнес-логика)
│   ├── Convertors/             # Конверторы данных
│   ├── Dtos/                   # Data Transfer Objects
│   ├── Factories/              # Фабрики для создания объектов
│   ├── Library/                # Библиотеки функций
│   ├── Models/                 # Модели предметной области
│   ├── Modeller/               # Модуль моделирования СМО
│   │   └── Supervisor.cs       # Диспетчер агентов
│   ├── Services/               # Бизнес-сервисы
│   └── Statistic/              # Сбор и анализ статистики
│
├── SimQ.DAL/                    # Data Access Layer
│   └── Repository/             # Репозитории для работы с БД
│
├── SimQ.Domain/                 # Доменные модели (Entity)
│   └── Models/                 # Entity классы
│
├── SimQ.WebApi/                 # REST API (ASP.NET Core)
│   ├── Controllers/            # API контроллеры
│   │   ├── ProblemsController.cs
│   │   └── TasksController.cs
│   ├── Migrations/             # Миграции данных
│   ├── Program.cs              # Точка входа приложения
│   └── appsettings.json        # Конфигурация
│
├── SimQ.Simulation/             # Модуль запуска симуляций
├── SimQ.Tests/                  # Модульные тесты
└── SimQ.sln                     # Solution файл
```

## 📚 API документация

### Основные эндпоинты

#### Управление задачами (Problems)

**GET** `/problems/v1/problems` — Получить список всех задач

**GET** `/problems/v1/problem/{problemId}` — Получить задачу по ID

**POST** `/problems/v1/problem` — Создать новую задачу
```json
{
  "name": "Название задачи",
  "description": "Описание",
  "agents": [...],
  "generationErrorSettings": {
    "generationErrorCheckStep": 10000,
    "generationErrorCheckStepModifier": 3,
    "minGenerationError": 0.00001
  }
}
```

**DELETE** `/problems/v1/problem/{problemId}` — Удалить задачу

**GET** `/problems/v1/problem/{problemId}/results` — Получить результаты задачи

#### Управление процессами (Tasks)

**GET** `/tasks/v1/tasks` — Получить список процессов

**POST** `/tasks/v1/task/run` — Запустить выполнение задачи

Полная документация API доступна в Swagger UI после запуска приложения:
`https://localhost:5001/swagger`

## 🔧 Разработка

### Архитектурные принципы

1. **Clean Architecture** — разделение на слои с минимальными зависимостями
2. **Dependency Injection** — инверсия зависимостей через DI контейнер
3. **Repository Pattern** — абстракция доступа к данным
4. **Factory Pattern** — создание агентов моделирования
5. **DTO Pattern** — разделение внутренних моделей и API контрактов

### Основные компоненты

#### Агенты моделирования (IModellingAgent)

Базовый интерфейс для всех агентов СМО. Агенты представляют узлы системы массового обслуживания (источники, каналы, очереди и т.д.).

#### Диспетчер (Supervisor)

Координирует взаимодействие между агентами, обеспечивает передачу заявок и управление событиями.

#### Сборщик статистики (StatisticCollector)

Собирает данные о работе системы в процессе моделирования для последующего анализа.

### Добавление нового типа агента

1. Создайте класс, реализующий `IModellingAgent`
2. Добавьте фабрику в `AgentFactory`
3. Обновите конверторы в `SimQ.Core/Convertors`
4. Добавьте DTO модели в `SimQ.Core/Dtos`

### Запуск тестов

```bash
dotnet test SimQ.Tests/SimQ.Tests.csproj
```

### Стиль кода

- **C#**: следуйте Microsoft coding conventions
- **TypeScript/React**: используйте ESLint и Prettier

## 📄 Лицензия

UNLICENSED — проект разработан в образовательных целях для Томского Государственного Университета.

## 👥 Авторы

Томский Государственный Университет (TSU)